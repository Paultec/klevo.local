<link rel="stylesheet" href="/css/jquery.dataTables.css">
<link rel="stylesheet" href="/css/shCore.css">
<style>
    .same-width a { width: 144px; }
</style>

<section class="col col-lg-3">
    <form id="redirect-form" action="<?php $this->url('product', array('controller' => 'edit'));?>" method="post">
        <input type="hidden" name="redirect" value="yes">
        <p>
            <span class="glyphicon glyphicon-arrow-left"></span>
            <input type="submit" class="btn btn-link" value="К добавлению товара">
        </p>
    </form>
    <aside class="filter">
        <h3><span class="glyphicon glyphicon-filter"></span> Каталог товаров</h3>
        <span class="link-type" data-type="<?php echo $this->type;?>"></span>
        <!-- Accordion -->
        <?php echo $this->catalog ;?><!-- /Accordion -->
    </aside>
</section>

<section class="col col-lg-9">
    <?php if (count($this->breadcrumbs) > 0) : ?>
        <ol class="breadcrumb">
            <?php
            foreach ($this->breadcrumbs as $key => $value) {
                if (is_object($value)) {
                    echo '<li><a href="?' . $key . '=' . $value->getId() . '">' . $value->getName() . '</a></li>';
                }
            }
            ?>
        </ol>
    <?php endif ?>
    <?php if ($this->result): ?>
        <table id="productList-table" class="table table-striped">
        <thead>
        <tr>
            <th>Название</th>
            <th>Описание</th>
            <th>Цена</th>
            <th>Изображение</th>
            <th>Действие</th>
        </tr>
        </thead>

        <tfoot>
        <tr>
            <th>Название</th>
            <th>Описание</th>
            <th>Цена</th>
            <th>Изображение</th>
            <th>Действие</th>
        </tr>
        </tfoot>
        <tbody>
        <?php foreach($this->result as $item): ?>
            <tr>
                <td><?php echo $item->getName(); ?></td>
                <td><?php echo $item->getDescription() ?: 'Нет'; ?></td>
                <td><?php echo $item->getPrice() / 100; ?></td>
                <td><?php echo $item->getImg() ?
                        '<a href="' . $this->url('editproduct', array('action' => 'img', 'id' => $item->getId())) . '">Да</a>' :
                        '<a href="' . $this->url('editproduct', array('action' => 'img', 'id' => $item->getId())) . '">Нет</a>'; ?>
                </td>
                <td class="same-width">
                    <a class="btn btn-primary" href="<?php echo $this->url('editproduct',
                        array('action'=>'edit', 'id' => $item->getId()));?>"><span class="glyphicon glyphicon-edit"></span> Редактировать</a>
                    <a class="btn btn-warning show-hide" href="<?php echo $this->url('editproduct',
                        array('action'=>'hide', 'id' => $item->getId()));?>"><span class="glyphicon glyphicon glyphicon-eye-close"></span> Скрыть</a>
                </td>
            </tr>
        <?php endforeach; ?>
        </tbody>
        </table>
    <?php else: ?>
        <h2>Выберите категорию для редактирования.</h2>
        <h2>Или добавьте <a href="<?php echo $this->url('editproduct', array('action' => 'add'));?>">новый</a> продукт.</h2>
    <?php endif ?>
</section>

<script src="/js/jquery.dataTables.js"></script>
<script src="/js/shCore.js"></script>
<script>
    $('#productList-table').dataTable({
        "language": {
            "url": "/resources/ru_RU.lg"
        }
    });
</script>